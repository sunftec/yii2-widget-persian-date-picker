/*
 AMIB Date Picker

 @version 0.3.1
 @created on 2013 November 4
 @copyright Amir Masoud Irani

 amib@amib.ir
 http://amib.ir
*/
if("function"!==typeof def)var def=function(b){return"undefined"!==typeof b};if("function"!==typeof fdef)var fdef=function(b){return"function"===typeof b};if(!fdef(A$))var A$=function(b){return document.getElementById(b)};if(!fdef(A$$))var A$$=function(b,a){return b.getElementsByTagName(a)};if(!fdef(cE))var cE=function(b){return document.createElement(b)};if(!fdef(rE))var rE=function(b){b.parentNode.removeChild(b)};if(!fdef(cTN))var cTN=function(b){return document.createTextNode(b)};
if(!def(AMIB))var AMIB={};AMIB.openedDatePickerIns=null;AMIB.openedMonthYearPickerIns=null;AMIB.topMostZIndex=9999;AMIB.PERSIAN_MONTH_NAMES="0 \u0641\u0631\u0648\u0631\u062f\u06cc\u0646 \u0627\u0631\u062f\u0628\u06cc\u0647\u0634\u062a \u062e\u0631\u062f\u0627\u062f \u062a\u06cc\u0631 \u0645\u0631\u062f\u0627\u062f \u0634\u0647\u0631\u06cc\u0648\u0631 \u0645\u0647\u0631 \u0622\u0628\u0627\u0646 \u0622\u0630\u0631 \u062f\u06cc \u0628\u0647\u0645\u0646 \u0627\u0633\u0641\u0646\u062f".split(" ");
AMIB.PERSIAN_SHORT_WEEKDAY_NAMES="0 \u0634 \u06cc\u06a9 \u062f\u0648 \u0633\u0647 \u0686\u0647 \u067e\u0646 \u062c\u0645".split(" ");AMIB.GREGORIAN_MONTH_NAMES="0 January February March April May June July August September October November December".split(" ");AMIB.GREGORIAN_SHORT_WEEKDAY_NAMES="0 Sat Sun Mon Tue Wed Thu Fri".split(" ");AMIB.todayJD=null;AMIB.todayPersian=null;AMIB.todayGregorian=null;
AMIB.datePickerDefaultOptions={extraInputID:"",extraInputFormat:"JD",initialDateJD:null,initialDatePersian:null,initialDateGregorian:null,defaultDateJD:null,defaultDatePersian:null,defaultDateGregorian:null,minDateJD:null,maxDateJD:null,supportPersian:!0,supportGregorian:!0,changeModeLinkInPicker:!0,mode:"persian",persianFormat:"yyyy/m/d",gregorianFormat:"YYYY/M/D",enabled:!0,disableAutoComplete:!0,createButtons:!0,pickerCssClass:"adpmain",buttonCssClass:"adpbtn",weekdaysClass:"saturday sunday monday tuesday thursday wednesday friday".split(" "),
onchange:null,onmodechange:null};AMIB.datePickerDefaultText={btnPersianText:"\u0647\u062c\u0631\u06cc \u0634\u0645\u0633\u06cc",btnGregorianText:"Gregorian",btnPersianTip:"\u0647\u062c\u0631\u06cc \u0634\u0645\u0633\u06cc",btnGregorianTip:"Gregorian",nextYearP:"\u0633\u0627\u0644 \u0628\u0639\u062f",prevYearP:"\u0633\u0627\u0644 \u0642\u0628\u0644",nextYearG:"Next year",prevYearG:"Prevoius year",todayP:"\u0627\u0645\u0631\u0648\u0632",todayG:"Today"};
AMIB.datePicker=function(b,a,c){this.options=objCopy(AMIB.datePickerDefaultOptions);this.text=objCopy(AMIB.datePickerDefaultText);this.input=b.nodeType?b:A$(b);for(var d in a)d in this.options?this.options[d]=a[d]:alert(d.toString()+" option is not supported");d=null;for(var e in c)e in this.options&&(this.text[e]=c[e]);this.oldDocumentOnClick=e=null;b=syncDateModes(this.options.defaultDateJD,this.options.defaultDatePersian,this.options.defaultDateGregorian);this.options.defaultDateJD=b[0];this.options.defaultDatePersian=
b[1];this.options.defaultDateGregorian=b[2];b=null;b=this.input;b.className+=" "+this.options.mode;!0==this.options.disableAutoComplete&&b.setAttribute&&b.setAttribute("autocomplete","off");if(this.options.createButtons){if(this.options.supportGregorian){var g=this;a=_crLnk("#","",this.options.buttonCssClass+" gregorian",this.text.btnGregorianTip,{click:function(a){"gregorian"!=g.options.mode&&(g.pickerDiv&&g.showHidePicker(a),g.changeMode("gregorian"));g.showHidePicker(a);_prvDef(a);_stopPrpg(a)}});
b.parentNode.insertBefore(a,b.nextSibling)}if(this.options.supportPersian){var f=this;a=_crLnk("#","",this.options.buttonCssClass+" persian",this.text.btnPersianTip,{click:function(a){"persian"!=f.options.mode&&(f.pickerDiv&&f.showHidePicker(a),f.changeMode("persian"));f.showHidePicker(a);_prvDef(a);_stopPrpg(a)}});b.parentNode.insertBefore(a,b.nextSibling)}}var h=this;addEvt(b,"dblclick",function(a){h.showHidePicker(a);return!1});var k=this;addEvt(b,"blur",function(){k.normalizeUserInput()});var p=
this;addEvt(b,"keydown",function(a){p.keyDownHandler(a,p)});b=syncDateModes(this.options.initialDateJD,this.options.initialDatePersian,this.options.initialDateGregorian);this.options.initialDateJD=b[0];this.options.initialDatePersian=b[1];this.options.initialDateGregorian=b[2];b[0]&&("persian"==this.options.mode?this.fillDateField(this.options.initialDatePersian):"gregorian"==this.options.mode&&this.fillDateField(this.options.initialDateGregorian))};var _adp=AMIB.datePicker.prototype;
_adp.showHidePicker=function(b){var a;if(this.pickerDiv){if(rE(this.pickerDiv),this.pickerDiv=null,document.onclick=this.oldDocumentOnClick,this.oldDocumentOnClick=null,AMIB.openedDatePickerIns=null,b=A$(AMIB.openedMonthYearPickerIns))rE(b),AMIB.openedMonthYearPickerIns=null}else if(!0===this.options.enabled){var c=this.input;this.pickerDiv=a=cE("div");a.className=this.options.pickerCssClass+" "+this.options.mode;this.createDateTable(a,c.value,c.value);getBaseOffsetParent(c).appendChild(a);this.setMenuPos(a,
c);a.style.zIndex=AMIB.topMostZIndex=9999;def(b)||(b=window.event);AMIB.openedDatePickerIns&&AMIB.openedDatePickerIns.showHidePicker(b);AMIB.openedDatePickerIns=this;_stopPrpg(b);this.oldDocumentOnClick=document.onclick;var d=this,e=b;document.onclick=function(){d.showHidePicker(e)}}};_adp.createDateTable=function(b,a,c){"persian"==this.options.mode?this.createDateTableP(b,a,c):"gregorian"==this.options.mode&&this.createDateTableG(b,a,c)};
_adp.createDateTableP=function(b,a,c){var d=cE("table"),e,g,f,h,k;g=this.options.defaultDatePersian;var p=this.options.minDateJD,q=this.options.maxDateJD,l=AMIB.getTodayJD(),j=AMIB.getTodayPersian();(a=isPersianDate(a))?a=persianToJD(a[0],a[1],a[2]):g?(a=persianToJD(g[0],g[1],g[2]),c=g.join("/")):a=l;c=isPersianDate(c);a=jdToPersian(a);var l=persianToJD(a[0],a[1],1),m=Math.floor(l+3)%7;e=d.insertRow(-1);g=e.insertCell(-1);g.className="pickerHead";g.colSpan=7;e=cE("div");e.className="navBack";var s=
this,t=a[0]-1,u=a[1];f=_crLnk("#","\u00ab","nav",this.text.prevYearP,{click:function(a){s.changePickerDate(a,t,u);_prvDef(a);_stopPrpg(a)}});e.appendChild(f);var v=this,w=1==a[1]?a[0]-1:a[0],x=1==a[1]?12:a[1]-1;f=_crLnk("#","<","nav",AMIB.PERSIAN_MONTH_NAMES[1==a[1]?12:a[1]-1],{click:function(a){v.changePickerDate(a,w,x);_prvDef(a);_stopPrpg(a)}});e.appendChild(f);g.appendChild(e);e=cE("div");e.className="navFwd";var y=this,z=a[0]+1,A=a[1];f=_crLnk("#","\u00bb","nav",this.text.nextYearP,{click:function(a){y.changePickerDate(a,
z,A);_prvDef(a);_stopPrpg(a)}});e.appendChild(f);var B=this,C=12==a[1]?a[0]+1:a[0],D=12==a[1]?1:a[1]+1;f=_crLnk("#",">","nav",AMIB.PERSIAN_MONTH_NAMES[12==a[1]?1:a[1]+1],{click:function(a){B.changePickerDate(a,C,D);_prvDef(a);_stopPrpg(a)}});e.appendChild(f);g.appendChild(e);var E=this,F=a[1],G=a[0];f=_crLnk("#",AMIB.PERSIAN_MONTH_NAMES[a[1]],"monYear","",{click:function(a){E.showMonthPicker(a,F,G);_prvDef(a);_stopPrpg(a)}});g.appendChild(f);f=_crLnk;e=enDigitsToFa(a[0]);var H=this,I=a[1],J=a[0];
f=f("#",e,"monYear","",{click:function(a){H.showYearPicker(a,I,J);_prvDef(a);_stopPrpg(a)}});g.appendChild(f);e=d.insertRow(-1);for(h=1;7>=h;++h)g=e.insertCell(-1),g.appendChild(cTN(AMIB.PERSIAN_SHORT_WEEKDAY_NAMES[h])),g.className="calWeekdays";e=d.insertRow(-1);for(h=0;h<m;++h)g=e.insertCell(-1);h=m;for(k=persianMonthDays(a[0],a[1])+m;h<k;++h,++l){0===h%7&&(e=d.insertRow(-1));g=e.insertCell(-1);f=cE("a");f.href="#";a[2]=h-m+1;f.className="weekday";f.className+=" "+this.options.weekdaysClass[h%7];
c&&(a[2]==c[2]&&a[1]==c[1]&&a[0]==c[0])&&(f.className+=" selected");a[2]==j[2]&&(a[1]==j[1]&&a[0]==j[0])&&(f.className+=" today",f.title+=this.text.todayP);var r=!0;if(p&&l<p||q&&l>q)f.className+=" invalid",r=!1;f.onclick=function(a,b){return function(c){_prvDef(c);b?a.fillDateField(b):_stopPrpg(c)}}(this,!0===r?a.join("/"):!1);f.appendChild(cTN(enDigitsToFa(a[2])));g.appendChild(f)}h=0;for(k=7-(persianMonthDays(a[0],a[1])+m)%7;7!=k&&h<k;++h)g=e.insertCell(-1);e=d.insertRow(-1);g=e.insertCell(-1);
g.className="pickerFoot";g.colSpan=7;f=cE("a");f.appendChild(cTN(enDigitsToFa(this.text.todayP+": "+[j[2],AMIB.PERSIAN_MONTH_NAMES[j[1]],j[0]].join(" "))));f.href="#";c=f;var K=this,L=j.join("/");c.onclick=function(){K.fillDateField(L);return!1};g.appendChild(f);if(this.options.supportPersian&&this.options.supportGregorian&&this.options.changeModeLinkInPicker){e=d.insertRow(-1);g=e.insertCell(-1);g.className="chanageMode";g.colSpan=7;var n=this;f=_crLnk("#",this.text.btnGregorianText,"",this.text.btnGregorianTip,
{click:function(a){"gregorian"!=n.options.mode&&(n.showHidePicker(a),n.changeMode("gregorian"),n.showHidePicker(a));_prvDef(a);_stopPrpg(a)}});g.appendChild(f)}for(;b.firstChild;)rE(b.firstChild);b.appendChild(d)};
_adp.createDateTableG=function(b,a,c){var d=cE("table"),e,g,f,h,k;g=this.options.defaultDateGregorian;var p=this.options.minDateJD,q=this.options.maxDateJD,l=AMIB.getTodayJD(),j=AMIB.getTodayGregorian();(a=isGregorianDate(a))?a=gregorianToJD(a[0],a[1],a[2]):g?(a=this.options.defaultDateJD,c=g.join("/")):a=l;c=isGregorianDate(c);a=jdToGregorian(a);var l=gregorianToJD(a[0],a[1],1),m=Math.floor(l+3)%7;e=d.insertRow(-1);g=e.insertCell(-1);g.className="pickerHead";g.colSpan=7;e=cE("div");e.className="navBack";
var s=this,t=a[0]-1,u=a[1];f=_crLnk("#","\u00ab","nav",this.text.prevYearG,{click:function(a){s.changePickerDate(a,t,u);_prvDef(a);_stopPrpg(a)}});e.appendChild(f);var v=this,w=1==a[1]?a[0]-1:a[0],x=1==a[1]?12:a[1]-1;f=_crLnk("#","<","nav",AMIB.GREGORIAN_MONTH_NAMES[1==a[1]?12:a[1]-1],{click:function(a){v.changePickerDate(a,w,x);_prvDef(a);_stopPrpg(a)}});e.appendChild(f);g.appendChild(e);e=cE("div");e.className="navFwd";var y=this,z=a[0]+1,A=a[1];f=_crLnk("#","\u00bb","nav",this.text.nextYearG,{click:function(a){y.changePickerDate(a,
z,A);_prvDef(a);_stopPrpg(a)}});e.appendChild(f);var B=this,C=12==a[1]?a[0]+1:a[0],D=12==a[1]?1:a[1]+1;f=_crLnk("#",">","nav",AMIB.GREGORIAN_MONTH_NAMES[12==a[1]?1:a[1]+1],{click:function(a){B.changePickerDate(a,C,D);_prvDef(a);_stopPrpg(a)}});e.appendChild(f);g.appendChild(e);var E=this,F=a[1],G=a[0];f=_crLnk("#",AMIB.GREGORIAN_MONTH_NAMES[a[1]],"monYear","",{click:function(a){E.showMonthPicker(a,F,G);_prvDef(a);_stopPrpg(a)}});g.appendChild(f);f=_crLnk;e=faDigitsToEn(a[0]);var H=this,I=a[1],J=a[0];
f=f("#",e,"monYear","",{click:function(a){H.showYearPicker(a,I,J);_prvDef(a);_stopPrpg(a)}});g.appendChild(f);e=d.insertRow(-1);for(h=1;7>=h;++h)g=e.insertCell(-1),g.appendChild(cTN(AMIB.GREGORIAN_SHORT_WEEKDAY_NAMES[h])),g.className="calWeekdays";e=d.insertRow(-1);for(h=0;h<m;++h)g=e.insertCell(-1);h=m;for(k=gregorianMonthDays(a[0],a[1])+m;h<k;++h,++l){0===h%7&&(e=d.insertRow(-1));g=e.insertCell(-1);f=cE("a");f.href="#";a[2]=h-m+1;f.className="weekday";f.className+=" "+this.options.weekdaysClass[h%
7];c&&(a[2]==c[2]&&a[1]==c[1]&&a[0]==c[0])&&(f.className+=" selected");a[2]==j[2]&&(a[1]==j[1]&&a[0]==j[0])&&(f.className+=" today",f.title+=this.text.todayG);var r=!0;if(p&&l<p||q&&l>q)f.className+=" invalid",r=!1;f.onclick=function(a,b){return function(c){_prvDef(c);b?a.fillDateField(b):_stopPrpg(c)}}(this,!0===r?a.join("/"):!1);f.appendChild(cTN(a[2]));g.appendChild(f)}h=0;for(k=7-(gregorianMonthDays(a[0],a[1])+m)%7;7!=k&&h<k;++h)g=e.insertCell(-1);e=d.insertRow(-1);g=e.insertCell(-1);g.className=
"pickerFoot";g.colSpan=7;f=cE("a");f.appendChild(cTN(this.text.todayG+": "+j[2].toString()+" "+AMIB.GREGORIAN_MONTH_NAMES[j[1]]+" "+j[0].toString()));f.href="#";c=f;var K=this,L=j.join("/");c.onclick=function(){K.fillDateField(L);return!1};g.appendChild(f);if(this.options.supportPersian&&this.options.supportGregorian&&this.options.changeModeLinkInPicker){e=d.insertRow(-1);g=e.insertCell(-1);g.className="chanageMode";g.colSpan=7;var n=this;f=_crLnk("#",this.text.btnPersianText,"",this.text.btnPersianTip,
{click:function(a){"persian"!=n.options.mode&&(n.showHidePicker(a),n.changeMode("persian"),n.showHidePicker(a));_prvDef(a);_stopPrpg(a)}});g.appendChild(f)}for(;b.firstChild;)rE(b.firstChild);b.appendChild(d)};_adp.changePickerDate=function(b,a,c){this.pickerDiv&&(b=[a,c,1].join("/"),this.createDateTable(this.pickerDiv,b,this.input.value))};
_adp.showMonthPicker=function(b,a,c){var d,e;b||(b=window.event);(d=A$(AMIB.openedMonthYearPickerIns))&&rE(d);d=cE("div");d.className="monthYearPicker";d.id=AMIB.openedMonthYearPickerIns=this.inputID+"monthYearPicker";for(var g=1;12>=g;++g)e="",g==a&&(e="selected"),e=_crLnk("#","persian"==this.options.mode?AMIB.PERSIAN_MONTH_NAMES[g]:AMIB.GREGORIAN_MONTH_NAMES[g],e,"",{click:function(a,b,c){return function(d){a.monthYearPickerClick(d,b,c);_prvDef(d);_stopPrpg(d)}}(this,g,c)}),d.appendChild(e);document.body.appendChild(d);
this.setMenuPos(d,b.target||b.srcElement);d.style.zIndex=++AMIB.topMostZIndex};
_adp.showYearPicker=function(b,a,c){var d,e,g;if(this.pickerDiv){b||(b=window.event);(d=A$(AMIB.openedMonthYearPickerIns))&&rE(d);_stopPrpg(b);d=cE("div");d.className="monthYearPicker";d.id=AMIB.openedMonthYearPickerIns=this.inputID+"monthYearPicker";for(g=c-5;g<=c+5;++g)g==c&&(e.className="selected"),e=_crLnk("#","persian"==this.options.mode?enDigitsToFa(g):g.toString(),"","",{click:function(a,b,c){return function(d){a.monthYearPickerClick(d,b,c);_prvDef(d);_stopPrpg(d)}}(this,a,g)}),d.appendChild(e);
document.body.appendChild(d);this.setMenuPos(d,b.target||b.srcElement);d.style.zIndex=++AMIB.topMostZIndex}};
_adp.changeMode=function(b){var a,c;this.options.mode!=b&&(this.options.mode=b,a=this.input.className,"persian"==b?((c=isGregorianDate(this.input.value))&&this.fillDateField(jdToPersian(gregorianToJD(c[0],c[1],c[2]))),a=removeCssClass(a,"gregorian")):"gregorian"==b&&((c=isPersianDate(this.input.value))&&this.fillDateField(jdToGregorian(persianToJD(c[0],c[1],c[2]))),a=removeCssClass(a,"persian")),this.input.className=a+" "+b,fdef(this.options.onmodechange)&&this.options.onmodechange.call(this,b))};
_adp.setMenuPos=function(b,a){var c=getOffset(a);b.style.top=0>c.top-b.offsetHeight||getScrlTop()+getViewPortHeight()>c.top+a.offsetHeight+b.offsetHeight?c.top+a.offsetHeight+"px":c.top-b.offsetHeight+"px";c=getOffset(a);b.style.left="rtl"==getDirection(a.parentNode)?c.left+a.offsetWidth-b.offsetWidth+"px":c.left+"px"};
_adp.monthYearPickerClick=function(b,a,c){var d;b||(b=window.event);_stopPrpg(b);(d=A$(AMIB.openedMonthYearPickerIns))&&rE(d);AMIB.openedMonthYearPickerIns=!1;b=[c,a,1].join("/");this.createDateTable(this.pickerDiv,b,this.input.value)};
_adp.normalizeUserInput=function(){var b=this.input,a;a=0;var c=faDigitsToEn(b.value.trim()),d="persian"==this.options.mode?isPersianDate(c):isGregorianDate(c);d&&(a="persian"==this.options.mode?persianToJD(d[0],d[1],d[2]):gregorianToJD(d[0],d[1],d[2]));d&&(!this.options.minDateJD||a>=this.options.minDateJD)&&(!this.options.maxDateJD||a<=this.options.maxDateJD)?this.fillDateField(d):(a=removeCssClass(b.className,"valid"),a=removeCssClass(a,"invalid"),""!==c&&(a+=" invalid"),b.className=a,this.options.extraInputID&&
(A$(this.options.extraInputID).value=""),fdef(this.options.onchange)&&this.options.onchange.call(this,!1,!1,!1))};
_adp.fillDateField=function(b){var a=this.input,c,d,e;"persian"==this.options.mode?(c=isPersianDate(b),e=persianToJD(c[0],c[1],c[2]),d=jdToGregorian(e),a.value=this.formatDate(e,c,d,this.options.persianFormat)):"gregorian"==this.options.mode&&(d=isGregorianDate(b),e=gregorianToJD(d[0],d[1],d[2]),c=jdToPersian(e),a.value=this.formatDate(e,c,d,this.options.gregorianFormat));b=removeCssClass(a.className,"invalid");b=removeCssClass(b,"valid");a.className=b+" valid";this.options.extraInputID&&(A$(this.options.extraInputID).value=
this.formatDate(e,c,d,this.options.extraInputFormat));fdef(this.options.onchange)&&this.options.onchange.call(this,c.slice(0),d.slice(0),e)};_adp.setMinDate=function(b,a,c){var d;this.options.minDateJD=c?c:(d=isPersianDate(b))?persianToJD(d[0],d[1],d[2]):(d=isGregorianDate(a))?gregorianToJD(d[0],d[1],d[2]):null};_adp.setMaxDate=function(b,a,c){var d;this.options.maxDateJD=c?c:(d=isPersianDate(b))?persianToJD(d[0],d[1],d[2]):(d=isGregorianDate(a))?gregorianToJD(d[0],d[1],d[2]):null};
AMIB.setToday=function(b,a,c){b=syncDateModes(b,a,c);AMIB.todayJD=b[0];AMIB.todayPersian=b[1];AMIB.todayGregorian=b[2]};AMIB.getTodayJD=function(){if(AMIB.todayJD)return AMIB.todayJD;var b=new Date;return gregorianToJD(b.getFullYear(),b.getMonth()+1,b.getDate())};AMIB.getTodayPersian=function(){return AMIB.todayPersian?AMIB.todayPersian:jdToPersian(AMIB.getTodayJD())};AMIB.getTodayGregorian=function(){return AMIB.todayGregorian?AMIB.todayGregorian:jdToGregorian(AMIB.getTodayJD())};
_adp.formatDate=function(b,a,c,d){d=d.replace(/yyyy/g,zeroPad(a[0],4));d=d.replace(/mm/g,zeroPad(a[1],2));d=d.replace(/dd/g,zeroPad(a[2],2));d=d.replace(/yy/g,zeroPad(a[0]%100,2));d=d.replace(/m/g,a[1].toString());d=d.replace(/d/g,a[2].toString());d=d.replace(/JD/g,b);d=d.replace(/UT/g,Math.floor(86400*(b-2440587.5),10));d=d.replace(/YYYY/g,zeroPad(c[0],4));d=d.replace(/MM/g,zeroPad(c[1],2));d=d.replace(/DD/g,zeroPad(c[2],2));d=d.replace(/YY/g,zeroPad(c[0]%100,2));d=d.replace(/M/g,c[1].toString());
return d=d.replace(/D/g,c[2].toString())};
_adp.keyDownHandler=function(b,a){var c;b||(b=window.event);if(b.keyCode)c=b.keyCode;else if(b.which)c=b.which;else return!1;if(!(48<=c&&57>=c||96<=c&&105>=c||0<=[191,111,190,110,173,109,8,9,46,13,35,36,37,39].indexOf(c)))if(38===c||40===c){var d=isPersianDate(a.input.value);!1!==d&&(38===c?a.fillDateField(jdToPersian(persianToJD(d[0],d[1],d[2])+1)):40===c&&a.fillDateField(jdToPersian(persianToJD(d[0],d[1],d[2])-1)),a.input.select(),_prvDef(b))}else b.ctrlKey||_prvDef(b)};
if(!fdef(getBaseOffsetParent))var getBaseOffsetParent=function(b){for(;b.offsetParent&&!(b=b.offsetParent,"fixed"==computedStyle(b,"position")););return b};
function isPersianDate(b){var a;if(b instanceof Array)a=b.slice(0);else if(0===b.search(/^\d+\-\d+\-\d+$/))a=b.split("-",3);else if(0===b.search(/^\d+\.\d+\.\d+$/))a=b.split(".",3);else if(0===b.search(/^\d+\/\d+\/\d+$/))a=b.split("/",3);else if(0===b.search(/^(\d{6}|\d{8})$/))a=[b.substr(0,2),b.substr(2,2),b.substr(4,b.length-4)];else if((a=b.match(/^(\d{2})(\d{2})$/))||(a=b.match(/^(\d{1,2})[/\-](\d{1,2})$/))||(a=b.match(/^(\d{1,2})$/)))b=AMIB.getTodayPersian(),a[0]=b[0],def(a[2])||(a[2]=b[1]),
12>=parseInt(a[2],10)&&(b=a[1],a[1]=a[2],a[2]=b);else return!1;for(b=0;2>=b;++b)a[b]=parseInt(a[b],10);if(12<a[1]||0>=a[1])return!1;a[2]>persianMonthDays(persianLongYear(a[0]),a[1])&&(b=a[2],a[2]=a[0],a[0]=b);if(9999<a[0])return!1;100>a[0]&&(a[0]=persianLongYear(a[0]));return 0===a[2]||a[2]>persianMonthDays(a[0],a[1])?!1:a}
function isGregorianDate(b){var a;if(b instanceof Array)a=b.slice(0);else if(0===b.search(/^\d+\-\d+\-\d+$/))a=b.split("-",3);else if(0===b.search(/^\d+\.\d+\.\d+$/))a=b.split(".",3);else if(0===b.search(/^\d+\/\d+\/\d+$/))a=b.split("/",3);else if(0===b.search(/^(\d{6}|\d{8})$/))a=[b.substr(0,2),b.substr(2,2),b.substr(4,b.length-4)];else if((a=b.match(/^(\d{2})(\d{2})$/))||(a=b.match(/^(\d{1,2})[/\-](\d{1,2})$/))||(a=b.match(/^(\d{1,2})$/)))b=AMIB.getTodayGregorian(),a[0]=b[0],def(a[2])||(a[2]=b[1]),
12>=parseInt(a[2],10)&&(b=a[1],a[1]=a[2],a[2]=b);else return!1;for(b=0;2>=b;++b)a[b]=parseInt(a[b],10);if(12<a[1]||0>=a[1])return!1;a[2]>gregorianMonthDays(gregorianLongYear(a[0]),a[1])&&(b=a[2],a[2]=a[0],a[0]=b);if(9999<a[0])return!1;100>a[0]&&(a[0]=gregorianLongYear(a[0]));return 0===a[2]||a[2]>gregorianMonthDays(a[0],a[1])?!1:a}
function syncDateModes(b,a,c){b?(a=jdToPersian(b),c=jdToGregorian(b)):a?(a instanceof Array||(a=isPersianDate(a)),b=persianToJD(a[0],a[1],a[2]),c=jdToGregorian(b)):c?(c instanceof Array||(c=isGregorianDate(c)),b=gregorianToJD(c[0],c[1],c[2]),a=jdToPersian(b)):b=a=c=null;return[b,a,c]}function persianLongYear(b){var a;if(100<=b)return b;var c=AMIB.getTodayPersian()[0];a=100*Math.floor(c/100);c=c-a-b;-30>c?a-=100:70<c&&(a+=100);return a+b}
function gregorianLongYear(b){var a;if(100<=b)return b;var c=AMIB.getTodayGregorian()[0];a=100*Math.floor(c/100);c=c-a-b;-30>c?a-=100:70<c&&(a+=100);return a+b}var GREGORIAN_EPOCH=1721425.5,PERSIAN_EPOCH=1948320.5;if(!fdef(mod))var mod=function(b,a){return b-a*Math.floor(b/a)};function leapPersian(b){return 682>682*((b-(0<b?474:473))%2820+512)%2816}
function jdToPersian(b){var a,c,d;b=Math.floor(b)+0.5;c=b-2121445.5;a=Math.floor(c/1029983);d=mod(c,1029983);1029982==d?c=2820:(c=Math.floor(d/366),d=mod(d,366),c=Math.floor((2134*c+2816*d+2815)/1028522)+c+1);a=c+2820*a+474;0>=a&&a--;c=b-persianToJD(a,1,1)+1;c=186>=c?Math.ceil(c/31):Math.ceil((c-6)/30);b=b-persianToJD(a,c,1)+1;return[a,c,b]}
function persianToJD(b,a,c){var d;b-=0<=b?474:473;d=474+mod(b,2820);return c+(7>=a?31*(a-1):30*(a-1)+6)+Math.floor((682*d-110)/2816)+365*(d-1)+1029983*Math.floor(b/2820)+(PERSIAN_EPOCH-1)}function leapGregorian(b){return 0===b%4&&!(0===b%100&&0!==b%400)}
function jdToGregorian(b){var a,c,d,e;b=Math.floor(b-0.5)+0.5;a=b-GREGORIAN_EPOCH;c=Math.floor(a/146097);d=mod(a,146097);a=Math.floor(d/36524);e=mod(d,36524);d=Math.floor(e/1461);e=mod(e,1461);e=Math.floor(e/365);c=400*c+100*a+4*d+e;4==a||4==e||c++;a=b-gregorianToJD(c,1,1);d=b<gregorianToJD(c,3,1)?0:leapGregorian(c)?1:2;a=Math.floor((12*(a+d)+373)/367);b=b-gregorianToJD(c,a,1)+1;return[c,a,b]}
function gregorianToJD(b,a,c){return GREGORIAN_EPOCH-1+365*(b-1)+Math.floor((b-1)/4)+-Math.floor((b-1)/100)+Math.floor((b-1)/400)+Math.floor((367*a-362)/12+(2>=a?0:leapGregorian(b)?-1:-2)+c)}function persianMonthDays(b,a){return 6>=a?31:11>=a?30:12==a?leapPersian(b)?30:29:0}function gregorianMonthDays(b,a){return 0<=[1,3,5,7,8,10,12].indexOf(a)?31:2==a?leapGregorian(b)?29:28:30}if(!fdef(_stopPrpg))var _stopPrpg=function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0};
if(!fdef(_prvDef))var _prvDef=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1};if(!fdef(faDigitsToEn))var faDigitsToEn=function(b){b=b.toString();for(var a=b.length,c="",d=0;d<a;++d)c+=String.fromCharCode(1776<=b.charCodeAt(d)&&1785>=b.charCodeAt(d)?b.charCodeAt(d)-1728:b.charCodeAt(d));return c};
if(!fdef(enDigitsToFa))var enDigitsToFa=function(b){b=b.toString();for(var a=b.length,c="",d=0;d<a;++d)c+=String.fromCharCode(48<=b.charCodeAt(d)&&57>=b.charCodeAt(d)?b.charCodeAt(d)+1728:b.charCodeAt(d));return c};"trim"in String.prototype||(String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")});"map"in Array.prototype||(Array.prototype.map=function(b,a){for(var c=Array(this.length),d=0,e=this.length;d<e;d++)d in this&&(c[d]=b.call(a,this[d],d,this));return c});
if(!fdef(removeCssClass))var removeCssClass=function(b,a){return b.split(/\s+/).map(function(b){return b===a?"":b}).join(" ")};if(!fdef(getOffset))var getOffset=function(b){for(var a=0,c=0,d=getBaseOffsetParent(b);b&&b!=d&&!isNaN(b.offsetLeft)&&!isNaN(b.offsetTop);)a+=b.offsetLeft-b.scrollLeft,c+=b.offsetTop-b.scrollTop,b=b.offsetParent;return{top:c,left:a}};
if(!fdef(zeroPad))var zeroPad=function(b,a){var c=Math.abs(b),d=Math.max(0,a-Math.floor(c).toString().length),d=Math.pow(10,d).toString().substr(1);0>b&&(d="-"+d);return d+c};if(!fdef(getViewPortHeight))var getViewPortHeight=function(){return def(window.innerWidth)?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight};
if(!fdef(getScrlTop))var getScrlTop=function(b){var a=0;if(def(b)){for(;(b=b.parentNode)&&"BODY"!==b.nodeName&&def(b.scrollTop);)a+=b.scrollTop;return a}if(def(window.pageYOffset))return window.pageYOffset;b=document.body;a=document.documentElement;a=a.clientHeight?a:b;return a.scrollTop};if(!fdef(addEvt))var addEvt=function(b,a,c){b.addEventListener?b.addEventListener(a,c,!1):b.attachEvent&&b.attachEvent("on"+a,c)};
if(!fdef(objCopy))var objCopy=function(b){if("object"!==typeof b||!b||b.constructor===RegExp)return b;var a=new b.constructor,c;for(c in b)b.hasOwnProperty(c)&&(a[c]=objCopy(b[c]));return a};if(!fdef(getDirection))var getDirection=function(b){return computedStyle(b,"direction")};if(!fdef(computedStyle))var computedStyle=function(b,a){if(b.currentStyle)return b.currentStyle[a];if(window.getComputedStyle)return getComputedStyle(b,null).getPropertyValue(a)};
if(!fdef(_crLnk))var _crLnk=function(b,a,c,d,e){var g=cE("a");g.href=b;def(c)&&(g.className=c);def(a)&&g.appendChild(cTN(a));def(d)&&(g.title=d);for(var f in e)addEvt(g,f,e[f]);return g};def(jQuery)&&function(b){b.fn.amibDatePicker=function(a){return this.length&&this.first().data("amibDatePicker")?this.first().data("amibDatePicker"):this.each(function(c,d){var e=new AMIB.datePicker(d,a);b(d).data("amibDatePicker",e)})}}(jQuery);_adp=null;
